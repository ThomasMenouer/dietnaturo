{% extends 'base.html.twig' %}

{% block title %}Ateliers
{% endblock %}

{% block body %}


	<div class="container">
		<h1 class="text-center py-5">Les prochains ateliers</h1>
	</div>

	<div
		class="container mb-5">

		{# read and display several types of flash messages #}
		{% for label, messages in app.flashes(['success', 'danger']) %}
			{% for message in messages %}
				<div class="alert alert-{{ label }} mt-5">
					{{ message }}
				</div>
			{% endfor %}
		{% endfor %}

		<!-- Bouton Newsletter -->
		<div class="text-center mb-5">
			<button class="btn btn-custom-color text-white rounded-pill px-4" data-bs-toggle="modal" data-bs-target="#newsletterModal">
				S’inscrire à la Newsletter
			</button>
		</div>

		<!-- Modal Newsletter -->
		<div class="modal fade" id="newsletterModal" tabindex="-1" aria-labelledby="newsletterModalLabel" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered">
				<div class="modal-content rounded-4 shadow-lg border-0">
					<div class="modal-header border-0">
						<h5 class="modal-title fw-bold" id="newsletterModalLabel">S’inscrire à la newsletter</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
					</div>
					<div class="modal-body">
						<p>Recevez les prochains ateliers directement dans votre boîte mail !</p>

						{{ form_start(form) }}
						{{ form_errors(form) }}

						<div class="row g-3 align-items-center mb-3">
							<div class="col-auto">
								{{ form_label(form.email, null, {'label_attr': {'class': 'col-form-label'}}) }}
							</div>
							<div class="col-auto">
								{{ form_widget(form.email, {'attr': {'placeholder': 'exemple@domaine.com', 'class': 'form-control rounded-pill'}}) }}
							</div>
						</div>

						<div class="text-end mt-4">
							{{ form_widget(form.submit, {'attr': {'class': 'btn btn-custom-color rounded-pill text-white px-4'}}) }}
						</div>

						{{ form_end(form) }}
					</div>
				</div>
			</div>
		</div>
		<div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-4">

			{% set availableAteliers = ateliers|filter(a => a.isAvailable) %}

			{% if availableAteliers is empty %}
				<div class="col-12 col-md-12 col-lg-8 mx-auto">
					<div class="card rounded-4 shadow-sm h-100 border-0">
						<div class="card-body">
							<p class="card-text text-center">Aucun atelier disponible pour le moment. Revenez plus tard !</p>
						</div>
					</div>
				</div>
			{% else %}
				{% for atelier in availableAteliers %}
					<div class="col">
						<div class="card rounded-4 shadow-sm h-100 border-0">
							<img class="card-img-top rounded-top-4 object-fit-cover" style="height: 300px;" src="{{ asset('/images/ateliers/') ~ atelier.imageName }}" alt="{{ atelier.title }}">
							<div class="card-body d-flex flex-column justify-content-between">
								<div>
									<h5 class="card-title">{{ atelier.title }}</h5>
									<p class="card-text text-muted small mb-2">
										Atelier du
										{{ atelier.date | format_datetime('long', 'short', locale: 'fr') }}
									</p>
									<p class="card-text fw-semibold">
										{{ (atelier.price / 100) | format_currency('EUR') }}
									</p>
								</div>
								<div>
									{% if atelier.isVisio %}
										<span class="badge-atelier badge text-bg-primary rounded-pill py-2 my-1">Visio</span>
									{% else %}
										<span class="badge-atelier badge text-bg-secondary rounded-pill py-2 my-1">Présentiel</span>
									{% endif %}
								</div>
							</div>
							<div class="card-footer text-center border-0">
								<a href="{{ path('ateliers_detail', { "slug": atelier.slug }) }}" class="btn btn-custom-color text-white rounded-pill">Voir</a>
							</div>
						</div>
					</div>
				{% endfor %}
			{% endif %}
		</div>

	</div>


</div>{% endblock %}
